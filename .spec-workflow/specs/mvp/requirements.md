# 要件定義

このドキュメントは `2026-02-06` に作成されました(`933132a`)。

## Introduction

gh-issue-treefier の MVP。GitHub issue の依存関係（blocking/blocked by）をブラウザ上で DAG として可視化する。GitHub の issue dependencies 機能は依存関係を管理できるが、全体像を俯瞰することが難しい。本機能はグラフ表示によりボトルネックの特定を容易にする。

## Alignment with Product Vision

- **GitHub ネイティブ**: GitHub の issue dependencies API を直接利用し、外部 DB を使わない
- **gh CLI エコシステムとの統合**: `gh issue-treefier console` コマンドでサーバーを起動
- **シンプルな操作**: ブラウザでグラフを閲覧・操作できる

## 機能要件

### サーバー起動

- `gh issue-treefier console` コマンドでローカル HTTP サーバーを起動する
- `--port` オプションでポートを指定できる（未指定時は空きポートを自動採番）
- 起動時に使用ポート番号をコンソールに表示する
- 起動後、自動的にブラウザを開く

### GitHub API プロキシ

- `/api/github/rest/*` へのリクエストを GitHub REST API に転送する
- `/api/github/graphql` へのリクエストを GitHub GraphQL API に転送する
- go-gh の認証情報を自動的に付与する
- 認証エラー時は 401 を返す

### Issue 一覧取得

- 以下の条件で issue を検索できる
  - リポジトリ（デフォルト: 現在のリポジトリ）
  - GitHub プロジェクト
  - プロジェクトの任意フィールド（イテレーション、ステータス、カスタムフィールド等）
  - 状態（open / closed / all）
- GraphQL API を使用してプロジェクトとフィールド情報を取得する
- issue 番号、タイトル、状態、ラベルを含める
- 検索条件が不正な場合はエラーを表示する

### 依存関係取得

- 各 issue の blocked_by 関係を取得する
- ブロック元とブロック先の issue 番号を含める

### グラフ表示

- issue をノードとして表示する
- 依存関係をノード間の矢印（エッジ）で表示する
- Dagre による自動レイアウトを適用する
- パン（ドラッグ）とズーム（スクロール）操作ができる

### ノード情報表示

- ノードクリックで issue のタイトル、番号、状態を表示する
- GitHub への直接リンクを含める

## 非機能要件

MVP では必要最低限の非機能要件のみ定義する。

### パフォーマンス要件

- 100 件の issue で 2 秒以内にグラフ描画
- サーバー起動から 1 秒以内にブラウザ利用可能

### セキュリティ要件

- gh CLI の既存認証を使用（新規認証フロー不要）
- 外部サーバーへのデータ送信なし

### 信頼性要件

- GitHub API エラー時は適切なエラーメッセージを表示

### ユーザビリティ要件

- 初回起動時に設定不要で動作
