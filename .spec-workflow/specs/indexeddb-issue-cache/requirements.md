# 要件定義

このドキュメントは `2026-02-12` に作成されました(`83cae28`)。

## Introduction

現状、フィルタ条件（ステータスやフィールド値）を変更するたびに GitHub API からプロジェクトの全 issue を再取得しており、数秒の待ち時間が発生する。GitHub ProjectV2 API はサーバーサイドフィルタをサポートしていないため、実際には同じデータを何度も取得しているだけである。

ブラウザにデータをキャッシュし、キャッシュがある場合は即座に表示しつつ裏で最新データを取得・更新することで、体感速度を大幅に改善する。

## Alignment with Product Vision

product.md の成功指標「100件のissueを持つリポジトリでも2秒以内にグラフを描画」に対し、現状はフィルタ変更のたびに API 待ちが発生し目標を達成できていない。キャッシュにより、フィルタ変更時は API 呼び出しなしで即座に描画、再アクセス時もキャッシュから即座に描画できるため、この目標を安定的に達成できる。

## 機能要件

### 即時表示

- 一度表示したプロジェクトの issue データはブラウザにキャッシュされる
- 同じプロジェクトに再アクセスした際、キャッシュからデータを即座に表示する
- フィルタ条件（ステータス、フィールド値）を変更しても API を再呼び出しせず、キャッシュ済みデータから即座に絞り込み結果を表示する

### バックグラウンド更新

- キャッシュデータを表示した後、バックグラウンドで API から最新データを取得する
- 最新データの取得が完了したら、UI を自動的に更新する
- バックグラウンド更新中であることをユーザーに視覚的に示す
- キャッシュが存在しない初回アクセス時は、従来通り loading 表示で API から取得する

### 手動リフレッシュ

- ユーザーが手動でリフレッシュ操作を行った場合、キャッシュを無視して API から強制取得する

### データ変更時の整合性

- 依存関係の追加・削除（sub-issue、blocked-by）が成功した後、キャッシュを無効化する
- 次回のデータ取得時に最新データが反映される

### 非対応環境での動作

- キャッシュが利用できない環境（プライベートブラウジング等）でも、キャッシュなしで従来通り動作する
- キャッシュ関連の処理でエラーが発生しても、アプリケーション全体に影響しない

## 非機能要件

### パフォーマンス要件

- キャッシュヒット時、フィルタ変更による再描画は 100ms 以内に完了する
- バックグラウンドでのデータ取得が UI の操作をブロックしない

### 信頼性要件

- キャッシュの破損や不整合が発生しても、API からの再取得で自動回復する

### ユーザビリティ要件

- バックグラウンド更新中であることが視覚的にわかる
- バックグラウンド更新完了後、UI がシームレスに最新データに切り替わる
